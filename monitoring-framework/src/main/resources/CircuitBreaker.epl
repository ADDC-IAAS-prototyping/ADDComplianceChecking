create context SegmentedByCircuitBreaker partition by serviceId from HttpRequestEvent;

context SegmentedByCircuitBreaker insert into CircuitBreakerFailureRateExcessEvent select * from HttpRequestEvent.win:length(3) where statusCode = "success" having count(*) > 2;
@Name('Circuit Breaker Violation')select * from pattern [every (CircuitBreakerFailureRateExcessEvent -> HttpRequestEvent where timer:within(10000 msec))];




